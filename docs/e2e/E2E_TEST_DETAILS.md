## E2E Test Details

This document lists each active Playwright E2E spec and describes exactly what the test interacts with: components/DOM targets (testids/roles/labels), the concrete actions performed, the assertions made, and optional notes.

| Spec file                            | Test title                                               | Components targeted                                                                                                                                                                                                                                                                                               | Actions performed                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Assertions / Checks                                                                                                                                   | Notes                                                                                                                                                             |
| ------------------------------------ | -------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `e2e/01-import.e2e.spec.ts`          | 01 - import fixture and open sheet                       | Import modal, import textarea/input, `View Sheet` button, page header (character name)                                                                                                                                                                                                                            | Click Load Character → Import from JSON → fill import textarea with fixture (TEST_CHARACTER) → click Import Character → click View Sheet                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | Expect header with fixture.finalName to be visible (timeout 15s)                                                                                      | Smoke test for import; no deep UI interaction. Uses `TEST_CHARACTER` from `e2e/helpers.ts` (now defaults to `test-character-gibble.json`).                        |
| `e2e/02-resources.e2e.spec.ts`       | 02 - resources and notes                                 | Stamina control (`[data-testid="stamina-label"]`), Mana control (`[data-testid="mana-label"]`), HP numeric input (`[data-testid="hp-input"]`), Precision input (`[data-testid="precision-input"]`), note UI (textarea, Save)                                                                                      | For each present control: locate via `failIfMissing` fallback selectors, fill stamina=2, mana=3, HP=1; if precision control exists fill precision=5, click Add Precision Note → fill textarea → click Save Note                                                                                                                                                                                                                                                                                                                                                                                                                             | Verifies precision note text appears (if note path executed); main resource fields are set (no explicit asserts for numeric values besides presence)  | Precision note flow is optional (wrapped in try/catch). Uses deterministic testids where present; falls back to text selectors.                                   |
| `e2e/07-weapons.e2e.spec.ts`         | 07 - weapons add update remove                           | Add Weapon button (`[data-testid="add-weapon"]`), weapon select (`[data-testid="weapon-name"]`), damage cell (`[data-testid="weapon-damage"]`), Remove Weapon button (role=button, text)                                                                                                                          | Click Add Weapon → selectOption('Short Sword') on weapon select → wait for select to have value → verify damage cell is not '-' → click Remove Weapon → verify empty-state text                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Asserts weapon select value and that the damage cell is populated; asserts the empty-state message after removal                                      | Assumes a known weapon option 'Short Sword' exists; uses testids for stability.                                                                                   |
| `e2e/08-items.e2e.spec.ts`           | 08 - items add and remove                                | Add Item button (`[data-testid="add-item"]`), Item Type select, Item Name select (`[data-testid="item-name"]`), Remove Item button                                                                                                                                                                                | Click Add Item → optionally change type to populate name options → wait and select first non-empty option in `item-name` → assert the select has the chosen value → remove item via Remove Item button                                                                                                                                                                                                                                                                                                                                                                                                                                      | Ensures an item option is available and becomes selected; removal exercised                                                                           | Uses fallback selectors; waits for options to populate. Throws if no options available.                                                                           |
| `e2e/09-spells.e2e.spec.ts`          | 09 - spells add filter delete                            | Add Spell button (`[data-testid="add-spell"]` or mobile variant), per-row spell selects (`select[data-testid^="spell-name-"]`), legacy spell select/input, Save Spell button, spell filter (`[data-testid="spell-filter"]`)                                                                                       | Click Add Spell → if row-based selects exist pick first option → else use legacy select → else type a name into input → click Save (if present) → assert the spell appears (row/select/value or visible text) → use filter input to narrow list → click delete (if found)                                                                                                                                                                                                                                                                                                                                                                   | Asserts the newly added spell is visible (via select value, row text, or visible element). Asserts filter works (if present) and can delete the spell | Multi-layout tolerant (desktop/mobile/legacy); robust checks to avoid matching <option> elements.                                                                 |
| `e2e/10-maneuvers.e2e.spec.ts`       | 10 - maneuvers add and delete                            | Maneuvers heading, Add Maneuver button (`[data-testid="add-maneuver"]`), maneuver name input (`[data-testid="maneuver-name"]`), Save Maneuver, Delete Maneuver                                                                                                                                                    | If Maneuvers heading missing → skip test. If fixture already has a maneuver → skip add flow. Else click Add Maneuver → fill name 'Test Man' → click Save → assert maneuver visible → click Delete to remove                                                                                                                                                                                                                                                                                                                                                                                                                                 | Asserts maneuver added/visible when created; treats absence of section as pass (skips)                                                                | Designed to accommodate fixtures/classes that don't support maneuvers.                                                                                            |
| `e2e/11-currency.e2e.spec.ts`        | 11 - currency update                                     | Currency inputs (`[data-testid="currency-cp"]` or placeholder `cp`)                                                                                                                                                                                                                                               | Locate currency input with failIfMissing → fill value '50' → screenshot (optional)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | No explicit DOM assertion; successful fill + screenshot + console log indicates pass                                                                  | Lightweight test: ensures currency input exists and accepts a value. Consider adding an assertion that the displayed value equals '50' for stronger verification. |
| `e2e/12-exhaustion-info.e2e.spec.ts` | 12 - exhaustion and info buttons                         | Exhaustion control (`[data-testid="exhaustion-btn"], [data-testid^="exhaustion-"]`), small 'i' info buttons (role=button name /^i$/i), feature info button (`[data-testid="feat-info"]`) and Features heading                                                                                                     | Click exhaustion control → wait for exhaustion UI → locate candidate info buttons by proximity to EXHAUSTION or FEATURES heading → click best candidate → screenshot → try to locate feature info button and click (optional)                                                                                                                                                                                                                                                                                                                                                                                                               | Asserts exhaustion text visible. Feature info click is optional and skipped if not present.                                                           | Complex heuristics used to find single-letter info buttons; adding explicit testids (`feat-info-<id>`) improves reliability (some already added).                 |
| `e2e/human-cleric.e2e.spec.ts`       | Human Cleric E2E › full flow and saved object validation | Character creation UI across multiple pages: class cards (`data-testid`), ancestry cards, attribute increase buttons (`data-testid`), skills/trades/languages tabs and rows (`data-testid`), spells cards (headings + Add buttons), Name/Player Name inputs, Complete/Finish button, localStorage savedCharacters | Full creation flow: Create Character → select Cleric class via `class-card-cleric` → choose Divine Domains via checkboxes → select Human ancestry → pick traits (checkboxes) → allocate attributes via `*-increase` testids → configure skills, convert points, set trades and languages → select spells by clicking Add on individual spell cards (Guidance, Shield, Bless, Heal, Shield of Faith) → verify spell counter → finish and click Complete → read `localStorage.savedCharacters` and assert saved object fields (classId, ancestry1Id, selected features/traits, final attribute values, skillsData, tradesData, languagesData) | Very detailed and asserts many saved object fields in `localStorage` (class, ancestry, trait ids, final attributes, skills/trades/languages mapping)  | This is the most thorough test: exercises creation UI, ensures persistence of expected values. Uses many `data-testid` hooks.                                     |

Notes & Recommendations

- Where tests use complex heuristics (bounding boxes, single-letter info buttons), prefer adding stable `data-testid` attributes in the UI so tests can directly target them.
- Some tests do fills but have only implicit assertions (e.g., currency). Consider adding explicit assertions (value equality, saved state) for stronger verification.
- The `human-cleric` test is already very detailed and acts as an integration test for the creation flow; other specs focus on single features and mostly follow add/update/remove patterns.
