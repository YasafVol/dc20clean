# Context Summary (2026-01-16_0141)

Purpose: summarize recent Convex/Auth/storage migration work and current blocker.

Key actions completed
- Removed GitHub OAuth references; Google-only auth in `convex/auth.config.ts`.
- Installed `convex` + `@convex-dev/auth`, renamed Convex draft files to live.
- Wrapped app in `ConvexAuthProvider` using a shared client `src/lib/convexClient.ts`.
- Implemented Convex storage adapter using Convex client queries/mutations.
- Switched main flows to async storage adapter: character completion, load, edit, sheet, defense notes, level-up.
- Added `authTables` to `convex/schema.ts` and changed character ownership to `userId: v.id('users')`.
- Added character `id` field to schema and indexed by `userId + id`.
- Updated Convex mutations/queries to use app `id` (string) rather than Convex `_id`.
- Added `VITE_USE_CONVEX=true` to `.env.local`.
- Updated docs: `docs/plannedSpecs/CONVEX_MIGRATION_SPEC.md` and `convex/README.md` with `AUTH_SECRET` and new file names.

Blocker
- `npx convex dev` fails due to missing rotated auth secret variables:
  - Error seen: `AUTH_SECRET_1` (then `AUTH_SECRET_2`) required.
  - Current fix pending: set `AUTH_SECRET_1` in Convex dashboard (use any 32-byte hex).
  - A sample hex provided earlier: `bd3381577ed2d6fc390fbae44de9d789256a28034699e22989cd38d0a3ecf6c2`.

Notes
- If you want a single secret, remove all numbered secrets and keep only `AUTH_SECRET`.
- If numbered secrets exist, Convex expects the next rotation slot to be set.

Next steps once secrets are set
- Rerun `npx convex dev` to regenerate `convex/_generated`.
- Verify Convex auth + storage flows in the app.
