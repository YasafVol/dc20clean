
### Part 1: Detailed Header Hierarchy Reference (Up to H5)

This hierarchy is meticulously structured to reflect the logical flow of the original document, using bolded subheadings and indented topics as indicators for H4 and H5 levels.

```markdown
# CHAPTER 1: Core Rules
## Attributes & Prime Modifier
### Attributes
#### Might
#### Agility
#### Charisma
#### Intelligence
### Starting Attributes
#### Standard Method
#### Point Buy
#### Roll Method
### Attribute Limit
### Gaining Attribute Points
### Prime Modifier
#### Prime Modifier Value
## Variant Rules
#### Prime Modifier Equals Attribute Limit
#### Prime Modifier Sidebar
## Skills
### Skill List
### Might
#### Athletics
#### Intimidation
### Agility
#### Acrobatics
#### Trickery
#### Stealth
### Intelligence
#### Investigation
#### Medicine
#### Survival
### Charisma
#### Animal
#### Insight
#### Influence
### Prime
#### Awareness
## Trades
### Trades List
### Trade Tools
### Trade Attributes
### Artistry
#### Illustration
#### Musician
#### Theatre
### Crafting
#### Alchemy
#### Blacksmithing
#### Glassblowing
#### Herbalism
#### Jeweler
#### Leatherworking
#### Sculpting
#### Tinkering
#### Weaving
### Knowledge
#### Arcana
#### Engineering
#### History
#### Nature
#### Occultism
#### Religion
### Services
#### Brewing
#### Carpentry
#### Cartography
#### Cooking
#### Masonry
#### Vehicles
### Subterfuge
#### Cryptography
#### Disguise
#### Gaming
#### Lockpicking
## Languages
### Languages List
### Mortal Languages
### Exotic Languages
### Divine Languages
### Outer Languages
## Mastery & Training
### Mastery Types
### Gaining Mastery
### Skill Mastery
#### Skill Mastery Levels & Limits
#### Gaining Skill Mastery
#### Skill Mastery Level Increases
#### Skill Points
#### Increasing your Skill Mastery Limit
#### Skill Points to Increase Skill Mastery Limit
#### Lacking Skill Mastery
### Trade Mastery
#### Trade Mastery Levels & Limits
#### Gaining Trade Mastery
#### Trade Mastery Level Increases
#### Trade Points
#### Converting Skill Points to Trade Points
#### Increasing your Trade Mastery Limit
#### Trade Points to Increase Trade Mastery Limit
#### Lacking Trade Mastery
### Language Mastery
#### Language Mastery Levels
#### Language Mastery Limit
#### Gaining Language Mastery
#### Language Points
#### Converting Trade Points to Language Points
#### Lacking Language Mastery
### Combat Mastery
#### Combat Mastery Formula
### Combat Training
#### Gaining Combat Training
#### Lacking Combat Training
## Checks & Saves
### Types of Checks
### Types of Saves
### Checks
#### Flat Attribute Checks
#### Attack Checks
#### Spell Checks
#### Skill Checks
#### Trade Checks
#### Language Checks
### Special Checks
#### Check Contests
#### Check Categories
### Passive Skills
#### Passive Skill Formula
#### Permanent ADV and DisADV
### Saves
#### Attribute Saves
### Special Saves
#### Death Saves
#### Save Categories
### Save DC
#### Save DC Formula
### Dynamic Attack Saves
#### Dynamic Attack Save Outcomes
## Advantage & Disadvantage
### Gaining Advantage
### Stacking ADV or DisADV
### Combining ADV & DisADV
### Variable ADV & DisADV
## Multiple Check Penalty
## Check & Save Outcomes
### Critical Success & Failure
### Attack Checks & Spell Checks
### Saves, Skill Checks, & Trade Checks
### Degrees of Success & Failure
#### Degrees of Success
#### Degrees of Failure
## Attacks & Defenses
### Attacks
#### Attack Types
#### Martial Attacks
#### Spell Attacks
#### Attack Ranges
#### Melee Attack
#### Ranged Attack
#### Weapon Ranges
#### Determining if an Attack Hits
### Defenses
#### Precision Defense
##### PD Calculation
##### PD Formula
#### Area Defense
##### AD Calculation
##### AD Formula
### Health Points & Death's Door
#### Health Points
#### Health Points at 1st Level
#### Temporary Health Points
#### Health Thresholds
#### Death's Door
##### Entering Death's Door
##### Death Saves
##### Death's Door Sidebar
### Damage
#### Degrees of Damage
#### Hit & Miss
#### Hit Success (each 5)
#### Degrees of Damage Table
#### Critical Hits
#### Damage Calculation Sidebar
### Damage Types
#### Damage Type Categories
### Damage Vulnerability, Resistance, & Immunity
#### Damage Resistance
#### Damage Immunity
#### Damage Vulnerability
### Damage Reduction
### Stacking Damage Vulnerabilities, Resistances, & Immunities
### Damage Modifications
### Managing Damage Multiples
#### Multiple Damage Types
#### Bonus Damage Against Multiple Targets
#### Shared Damage

# CHAPTER 2: Combat Rules
## Combat Resources
### Action Points
#### AP Outside of Combat
### Mana Points
#### MP Outside of Combat
### Stamina Points
#### SP Outside of Combat
### Grit Points
#### Spending Grit Points
## Actions
### Taking an Action
### Types of Actions
### Offensive Actions
### Defensive Actions
### Utility Actions
### Skill Based Actions
### Advanced Actions
#### Held Actions
## Reactions
### Taking a Reaction
### Reaction Requirements
### Spending Resources
### Types of Reactions
#### Opportunity Attack
#### Spell Duel
##### Choosing a Spell
##### Contest
##### Wild Magic Table
## Maneuvers
### Multiple Maneuvers
### Maneuver Damage
### Save Effects
### Contest Effects
### Spending Stamina
### Attack Maneuvers
#### Extend Attack
#### Power Attack
#### Sweep Attack
### Save Maneuvers
#### Bleed
#### Daze
#### Expose
#### Hamstring
#### Hinder
#### Impair
#### Knockback
#### Trip
### Grapple Maneuvers
#### Body Block
#### Restrain
#### Slam
#### Takedown
#### Throw
### Defense Maneuvers
#### Parry
#### Protect
#### Raise Shield
#### Side Step
#### Swap
#### Taunt
## Techniques
### Learning Techniques
### Techniques List
### Technique Attack Checks
### Technique Enhancements
### Techniques
#### Forbearance
#### Heroic Bash
#### Heroic Leap
#### Heroic Parry
#### Heroic Taunt
#### Slip Away
#### Sunder Armor
#### Tumble and Dive
#### Volley
#### Whirlwind
## Spellcasting
### Spells Known
### Spell Lists
#### Arcane
#### Divine
#### Primal
#### Gaining a Spell List
### Spell Resources
#### Action Points
#### Mana Points
#### Spellcasting Without Mana Points
### Spell Enhancements
### Mana Spend Limit
### MP Effects
### Casting a Spell
#### Spell Check Vs Defense
#### Spell Check Vs Spell DC
#### Spell Check Vs Save
#### Dynamic Attack Save
#### Natural 1's
#### Targeting Multiple Creatures
#### Structure of Spellcasting Mechanics
### Spell Characteristics
#### Components
#### Duration
#### Sustain Action
#### Targets
#### Range
#### Areas of Effect
### Categorizing Spells
#### Schools of Magic
#### Spell Tags
### Advanced Spellcasting
#### Combo Spellcasting
#### Stacking Magical Effects
## Starting Combat
### Combat Encounters
### Encounter DC
#### Encounter DC Table
### Pre-Combat Aggression
### Initiative
#### Rolling for Initiative
#### Making an Initiative Check
#### Individual Outcomes
#### Party Outcomes
### Initiative Turns
#### Alternating Initiative Turns
#### Choosing PC Turns
#### Choosing Enemy Turns
#### Delayed Initiative
### Game Master Initiative Sidebar
#### Enemy Groupings
#### Unequal Number of Enemies
#### Shared Enemy Turns
#### Empty Enemy Turns
#### Multiple Enemy Teams
#### NPC Team
### Initiative Order
### Rounds of Combat
### Time in Combat
### Duration in Rounds
### Surprise in Combat

# CHAPTER 3: General Rules
## Environment
### Spaces & Distance
### Difficult Terrain
### Jumping
#### Jump Distance
### Falling
#### Controlled Falling
#### Uncontrolled Falling
#### Continuous Falling
#### Falling While Flying
### Climbing
### Swimming
### Holding Your Breath
#### Breath Duration
#### Calm Hold
#### Stressed Hold
#### Losing Your Breath
#### Suffocating
## Vision
### Line of Sight
### Cover
### Concealment
### Illumination
#### Bright Light
#### Dim Light
#### Darkness
### Vision
#### Darkvision
#### Tremorsense
#### Blindsight
#### Truesight
## Creatures & Combat
### Creatures
#### Creature Sizes
#### Moving & Grappling Creatures
#### Moving Through Creatures
#### Collision
#### Falling Attacks
### Throwing
#### Throwing Creatures
#### Throwing Objects
#### Throwing Melee Weapons
### Improvised Weapons
### Unarmed Strikes
### Natural Weapons
### Non-Lethal Attacks
### Dual Wielding
### Flanking
### Prone
### Hidden Creatures
### Unseen
### Unheard
### Hidden
### Underwater Combat
## Equipment
### Weapons
#### Weapon Types
#### Weapon Styles
#### Weapon Properties
#### Special Weapon Properties
#### Weapon Examples
#### Lacking Weapon Training
#### Customized Weapons
### Armor
#### Armor Type
#### Wearing Armor
#### Lacking Armor Training
#### Damage Reduction
#### Armor Examples
#### Customized Armor
### Shields
#### Shield Type
#### Wielding a Shield
#### Lacking Shield Training
#### Attacking With Shields
#### Wielding Two Shields
#### Shield Properties
#### Shield Table
#### Customized Shields
### Adventuring Supplies
#### Gauntlet
#### Healing Potions
#### First Aid Kit
## Conditions
### Conditions List
### Condition Resistance, Immunity, & Vulnerability
### Condition Stacking & Overlapping
## Resting
### Rest Terms
### Types of Rest
#### Quick Rest
#### Short Rest
#### Long Rest
#### Full Rest
## DCs in DC20
### Difficulty Class (DC)
### Setting a DC "by 5's"
### Great Success and Failure
### Complications
### Advantages and Disadvantages
### Failing Forward
## Game Master Guide
### Variable Attribute Skill Checks
#### Variable Attribute Rule
#### Variable Check Examples

# CHAPTER 4: Character Creation Rules
## 10 Step Character Creation Outline
## Player Character Creation
### Step 1: Attributes & Prime Modifier
### Step 2: Save Masteries
### Step 3: Background (Skills, Trades, & Languages)
### Step 4: Health Points
### Step 5: Stamina & Mana Points
### Step 6: Defense
### Step 7: Combat Modifiers
### Step 8: Ancestry
### Step 9: Class
### Step 10: Weapons & Inventory
## Further Player Character Progression
### Player Character Progression Table
### Leveling Up
## Talents
### Talent Requirements
### General Talents
#### Attribute Increase
#### Skill or Trade Increase
#### Martial Expansion
#### Spellcasting Expansion
### Class Talents
#### Barbarian
#### Bard
#### Champion
#### Cleric
#### Commander
#### Druid
#### Hunter
#### Monk
#### Rogue
#### Sorcerer
#### Spellblade
#### Warlock
#### Wizard
## Multiclass Talents
#### Novice Multiclass
#### Adept Multiclass
#### Expert Multiclass
#### Master Multiclass
#### Grandmaster Multiclass
#### Legendary Multiclass
## Character Paths
### Martial Path
#### Martial Path Table
#### Spellcasters With Stamina
### Spellcaster Path
#### Spellcaster Path Table
## Paragon Subclass
### Level 3 Subclass Feature
### Level 6 Subclass Feature
### Level 9 Subclass Feature

# CHAPTER 5: Ancestries
## Ancestry System
### Ancestry Traits
### Ancestry Points
### Gaining Ancestry Points
### Types of Ancestry Traits
## Ancestry Origins
### Ancestry Flavor vs Mechanics
### Ancestry Creation
#### Base Ancestry Traits
#### Choose Your Ancestry
#### Spend Your Ancestry Points
#### Gaining & Losing Negative Traits
### Duplicate Ancestry Traits
### Ancestry Trait Requirements
### Refunding Ancestry Traits
## Variant Rules
### Custom Ancestries
### Variable Negativity
### Stronger or Weaker Ancestries
### Ancestry Adoption
### Ancestry "Magic Items"
## Human
### Default Traits
### Expanded Traits
## Elf
### Default Traits
### Expanded Traits
## Dwarf
### Default Traits
### Expanded Traits
## Halfling
### Default Traits
### Expanded Traits
## Gnome
### Default Traits
### Expanded Traits
## Orc
### Default Traits
### Expanded Traits
## Dragonborn
### Draconic Origin
### Default Traits
### Expanded Traits
## Giantborn
### Default Traits
### Expanded Traits
## Angelborn
### Fallen Angelborn
### Default Traits
### Expanded Traits
## Fiendborn
### Fiendish Origin
### Fiendborn Redemption
### Default Traits
### Expanded Traits
## Beastborn
### Beastborn Origin
### Beast Traits
#### Senses
#### Mobility
#### Jumping
#### Flying
#### Body
#### Natural Weapons
#### Miscellaneous

# CHAPTER 6: Classes
## Barbarian
### Starting Equipment
### Barbarian Martial Path
### Barbarian Class Table
### Barbarian Class Features
#### Level 1 Class Features
##### Rage
##### Berserker
##### Shattering Force (Flavor Feature)
#### Level 2 Class Features
##### Battlecry
##### Talent
### Subclasses
#### Elemental Fury
##### Raging Elements
##### Elemental Affinity (Flavor Feature)
#### Spirit Guardian
##### Ancestral Guardian
##### Ancestral Knowledge (Flavor Feature)

## Bard
### Starting Equipment
### Bard Spellcasting Path
### Bard Class Table
### Bard Class Features
#### Level 1 Class Features
##### Font of Inspiration
##### Remarkable Repertoire
##### Crowd Pleaser (Flavor Feature)
#### Level 2 Class Features
##### Bardic Performance
##### Talent
### Subclasses
#### Eloquence
##### Beguiling Presence
##### Eloquent Orator (Flavor Feature)
#### Jester
##### Antagonizing Act
##### Comedian (Flavor Feature)

## Champion
### Starting Equipment
### Champion Martial Path
### Champion Class Table
### Champion Class Features
#### Level 1 Class Features
##### Master-at-Arms
##### Fighting Spirit
##### Know Your Enemy (Flavor Feature)
#### Level 2 Class Features
##### Adaptive Tactics
##### Talent
### Subclasses
#### Hero
##### Hero's Resolve
##### Adventuring Hero (Flavor Feature)
#### Sentinel
##### Stalwart Protector
##### Vigilant Watcher (Flavor Feature)

## Cleric
### Starting Equipment
### Cleric Spellcasting Path
### Cleric Class Table
### Cleric Class Features
#### Level 1 Class Features
##### Cleric Order
##### Divine Blessing
##### Divine Omen (Flavor Feature)
#### Level 2 Class Features
##### Channel Divinity
##### Talent
### Subclasses
#### Inquisitor
##### Vanquish Heresy
##### Divine Interrogator (Flavor Feature)
#### Priest
##### Sanctification
##### All That Ails (Flavor Feature)

## Commander
### Starting Equipment
### Commander Martial Path
### Commander Class Table
### Commander Class Features
#### Level 1 Class Features
##### Inspiring Presence
##### Commander's Call
##### Natural Leader (Flavor Feature)
#### Level 2 Class Features
##### Commanding Aura
##### Talent
### Subclasses
#### Crusader
##### Virtuous Vanguard
##### Gallant Hero (Flavor Feature)
#### Warlord
##### Offensive Tactics
##### Battlefield Tactician (Flavor Feature)

## Druid
### Starting Equipment
### Druid Spellcasting Path
### Druid Class Table
### Druid Class Features
#### Level 1 Class Features
##### Druid Domain
##### Wild Form
##### Wild Speech (Flavor)
#### Level 2 Class Features
##### Nature's Torrent
##### Talent
##### Wild Form Traits
### Subclasses
#### Phoenix
##### Flames of Rebirth
##### Fire Within (Flavor Feature)
#### Rampant Growth
##### Overgrowth
##### Seed Vault (Flavor Feature)

## Hunter
### Starting Equipment
### Hunter Martial Path
### Hunter Class Table
### Hunter Class Features
#### Level 1 Class Features
##### Hunter's Mark
##### Favored Terrain
##### Bestiary (Flavor Feature)
#### Level 2 Class Features
##### Hunter's Strike
##### Talent
### Subclasses
#### Monster Slayer
##### Monstrous Concoctions
##### Monster Concoction Recipes
##### Monster Hunter (Flavor Feature)
#### Trapper
##### Dynamic Traps
##### Discerning Eye (Flavor Feature)

## Monk
### Starting Equipment
### Monk Martial Path
### Monk Class Table
### Monk Class Features
#### Level 1 Class Features
##### Monk Training
##### Monk Stance
##### Meditation (Flavor Feature)
#### Level 2 Class Features
##### Spiritual Balance
##### Talent
### Subclasses
#### Astral Self
##### Astral Awakening
##### Astral Watch (Flavor Feature)
#### Shifting Tide
##### Ebb and Flow
##### Fluid Movement (Flavor Feature)

## Rogue
### Starting Equipment
### Rogue Martial Path
### Rogue Class Table
### Rogue Class Features
#### Level 1 Class Features
##### Debilitating Strike
##### Roguish Finesse
##### Cypher Speech (Flavor Feature)
#### Level 2 Class Features
##### Cheap Shot
##### Talent
### Subclasses
#### Long Death
##### Thousand Cuts
##### Hundred Ways to Die (Flavor Feature)
#### Swashbuckler
##### Renegade Duelist
##### Tall Tales (Flavor Feature)

## Sorcerer
### Starting Equipment
### Sorcerer Spellcasting Path
### Sorcerer Class Table
### Sorcerer Class Features
#### Level 1 Class Features
##### Innate Power
##### Sorcerous Origins
##### Sorcerer Wild Magic Table
##### Overload Magic
##### Sorcery (Flavor Feature)
#### Level 2 Class Features
##### Meta Magic
##### Talent
### Subclasses
#### Angelic
##### Celestial Spark
##### Celestial Appearance (Flavor Feature)
#### Draconic
##### Draconic Spark
##### Draconic Appearance (Flavor Feature)

## Spellblade
### Starting Equipment
### Spellblade Martial Path
### Spellblade Spellcasting Path
### Spellblade Class Table
### Spellblade Class Features
#### Level 1 Class Features
##### Bound Weapon
##### Spellblade Disciplines
##### Sense Magic (Flavor Feature)
#### Level 2 Class Features
##### Spellstrike
##### Talent
### Subclasses
#### Paladin
##### Holy Warrior
##### Oathsworn (Flavor Feature)
#### Rune Knight
##### Rune Weapon
##### Rune Expert (Flavor Feature)
##### Rune Names

## Warlock
### Starting Equipment
### Warlock Spellcasting Path
### Warlock Class Table
### Warlock Class Features
#### Level 1 Class Features
##### Warlock Contract
##### Pact Boon
##### Beseech Patron (Flavor Feature)
#### Level 2 Class Features
##### Life Tap
##### Talent
### Subclasses
#### Eldritch
##### Otherwordly Gift
##### Alien Comprehension (Flavor Feature)
#### Fey
##### Fey Aspect
##### Dream Walker (Flavor Feature)

## Wizard
### Starting Equipment
### Wizard Spellcasting Path
### Wizard Class Table
### Wizard Class Features
#### Level 1 Class Features
##### Spell School Initiate
##### Arcane Sigil
##### Ritual Caster (Flavor Feature)
#### Level 2 Class Features
##### Prepared Spell
##### Talent
### Subclasses
#### Portal Mage
##### Portal Magic
##### Portal Sage (Flavor Feature)
#### Witch
##### Coven's Gift
##### Hex Enhancements
##### Curse Expert (Flavor Feature)
```

***

### Part 2: Updated Plan for Agent

This revised plan incorporates the deeper hierarchy and the removal of OCR artifacts.

**Objective:** Create a clean, correctly-structured Markdown file (`DC20_corrected.md`) from the provided `DC20 0.95 full.md` and `DC20 - 0.95 - class and sub class feature choices.md` by applying a detailed header map and removing artifacts.

**Inputs:**
1.  `source_file_main`: The `DC20 0.95 full.md` file.
2.  `source_file_choices`: The `DC20 - 0.95 - class and sub class feature choices.md` file.
3.  `hierarchy_map`: The detailed header reference from Part 1.

---

#### **Agent Execution Plan:**

**Step 1: Initialization**
1.  Load the content of `source_file_main` into a single string or list of lines.
2.  Load the content of `source_file_choices` into a separate string or list of lines.
3.  Create an empty output file: `DC20_corrected.md`.
4.  Load the `hierarchy_map` into a sequential data structure.

**Step 2: Pre-processing and Cleaning**
1.  **Remove OCR Artifacts:**
    *   Iterate through the content of both source files.
    *   Use regular expressions or string matching to find and delete any lines that match the patterns `==Start of OCR for page X==` and `==End of OCR for page X==`.
2.  **Combine Source Files:**
    *   Append the cleaned content of `source_file_choices` to the end of the cleaned content from `source_file_main`. This ensures all text is in one place for processing.
3.  **Normalize Text for Searching:**
    *   Create a working copy of the combined content. For each line, create a "normalized" version for searching by:
        *   Removing leading/trailing whitespace.
        *   Removing Markdown formatting like `*`, `**`, and `#`.
        *   Removing trailing punctuation like `:`.
        *   Converting to a consistent case (e.g., lowercase).
    *   This will allow the agent to find a header like `#### Athletics` even if the source text has it written as `**Athletics:**`.

**Step 3: Sequential Header Application**
1.  Initialize a `current_line_index` to `0`.
2.  Iterate through the `hierarchy_map` from the first header to the last.
3.  For each `(level, "Header Text")` in the map:
    a. Create a normalized version of `"Header Text"` using the same logic as in Step 2.3.
    b. **Search:** Starting from `current_line_index`, scan through the *normalized* source content to find the first line that exactly matches the normalized header text.
    c. **If a match is found:**
        i. Get the index of the matching line in the *original* (un-normalized) content list.
        ii. Create the correct Markdown header (e.g., `#### Header Text`).
        iii. Replace the original line at that index with the new, correctly formatted header.
        iv. Update `current_line_index` to be the index of the line immediately following the match.
    d. **If a match is not found:**
        i. Log a warning: `Header not found: "Header Text"`.
        ii. Continue to the next header in the map.

**Step 4: Post-processing and Formatting**
1.  **Line Breaks:** After applying all headers, iterate through the modified content. Ensure there is a blank line before each header (except for H1 headers at the very beginning of the document) for better readability.
2.  **Redundant Text:** Some sections in the source `md` might have introductory text that is now redundant because of the new, more descriptive headers. This step would require more advanced natural language understanding, but a simpler version could look for common boilerplate phrases immediately following a newly-placed header and remove them. (This is an optional, advanced step).

**Step 5: Finalization**
1.  Write the final, cleaned, and correctly-headed content to `DC20_corrected.md`.
2.  Close the file.

This robust plan will not only fix the headers to a granular level but will also clean up the file by removing the OCR-specific metadata, resulting in a much cleaner and more professional final document.